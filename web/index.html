<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>StackIQ — Live Quote</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { font: 16px/1.4 system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 24px; }
    h1 { font-size: 20px; margin: 0 0 16px; }
    .row { display: flex; gap: 8px; align-items: center; margin: 8px 0 16px; }
    input { padding: 8px 10px; border: 1px solid #ccc; border-radius: 6px; min-width: 160px; }
    button { padding: 8px 12px; border: 0; border-radius: 6px; background: #1e90ff; color: #fff; cursor: pointer; }
    button:disabled { opacity: .6; cursor: default; }
    .card { border: 1px solid #eee; border-radius: 10px; padding: 16px; }
    .muted { color: #666; font-size: 14px; }
    .error { color: #b00020; }
    table { width: 100%; border-collapse: collapse; margin: 8px 0 12px; }
    th, td { text-align: left; padding: 6px 8px; }
  </style>
</head>
<body>
  <h1>StackIQ — Live Quote</h1>
  <div class="row">
    <input id="sym" value="AAPL" />
    <button id="go">Get Quote</button>
    <span id="err" class="error"></span>
  </div>

  <div id="out" class="card" hidden>
    <table>
      <tbody>
        <tr><th>Symbol</th><td id="s"></td></tr>
        <tr><th>Price</th><td id="c"></td></tr>
        <tr><th>Change</th><td id="p"></td></tr>
        <tr><th>Session High</th><td id="h"></td></tr>
        <tr><th>Session Low</th><td id="l"></td></tr>
        <tr><th>Open</th><td id="o"></td></tr>
        <tr><th>Prev Close</th><td id="pc"></td></tr>
      </tbody>
    </table>
    <div id="sum" class="muted"></div>
  </div>

  <div class="muted">API: <code>/quote/{symbol}</code>, <code>/summary/{symbol}</code></div>

  <script>
    const $ = id => document.getElementById(id);
    const go = $('go'), sym = $('sym'), out = $('out'), err = $('err');

    async function load() {
      err.textContent = ''; out.hidden = true; go.disabled = true;
      const symbol = sym.value.trim().toUpperCase();
      try {
        const [qRes, sRes] = await Promise.all([
          fetch(`/quote/${encodeURIComponent(symbol)}?pretty=1`),
          fetch(`/summary/${encodeURIComponent(symbol)}?pretty=1`)
        ]);
        if (!qRes.ok) throw new Error(`Quote error ${qRes.status}`);
        if (!sRes.ok) throw new Error(`Summary error ${sRes.status}`);
        const quote = await qRes.json();
        const summary = await sRes.json();

        $('s').textContent = quote.symbol;
        $('c').textContent = quote.current;
        $('p').textContent = (quote.percent_change ?? 0).toFixed(2) + '%';
        $('h').textContent = quote.high;
        $('l').textContent = quote.low;
        $('o').textContent = quote.open;
        $('pc').textContent = quote.prev_close;
        $('sum').textContent = summary.summary;
        out.hidden = false;
      } catch (e) {
        err.textContent = 'Failed to load: ' + e.message;
      } finally {
        go.disabled = false;
      }
    }

    go.addEventListener('click', load);
    sym.addEventListener('keydown', e => e.key === 'Enter' && load());

    // load once by default
    load();
  </script>
</body>
</html>






